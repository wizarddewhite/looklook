<div class="group">
<span class="pull-right">
  <% if current_user && current_user.has_joined_course?(@course) %>
    <label class="label label-success"> 课程学员 </label>
    <%= link_to("Quit Course", quit_course_path(@course), method: :post, class: "btn btn-default") %>
  <% else %>
    <label class="label label-warning"> 未参加课程 </label>
    <%= link_to("Join Course", join_course_path(@course), method: :post, class: "btn btn-default") %>
  <% end %>
</span>

<% if current_user && current_user == @course.user %>
  <%= link_to("Edit", edit_course_path(@course), class: "btn btn-primary pull-right")%>
<% end %>
</div>

<h1> <%= @course.title %> </h1>
<p> Price <%= @course.price %> </p>

<p> <%= render_course_description(@course) %> </p>

<% if current_user && @course.user == current_user %>
<div>
    <%= link_to("Add Coupon", new_course_coupon_path(@course), class: "btn btn-primary pull-right")%>
  <table class="table table-boldered">
    <thread>
    <tr>
      <td>Price</td>
      <td>Quantity</td>
    </tr>
    </thread>
    <tbody>
    <% @course.coupons.each do |c| %>
    <tr>
      <td>
        <%= c.price %>
      </td>
      <td>
        <%= c.quantity %>
      </td>
      <td>
        <%= link_to("Destroy", course_coupon_path(@course, c), :method => :delete, :data => { :confirm => "Are you sure?" }) %>
      </td>
    </tr>
    <% end %>
    </tbody>
  </table>
</div>
<% end %>

<div>
<% if current_user && @course.user == current_user %>
  <%= link_to("Add a video", new_course_video_path(@course), class: "btn btn-primary pull-right")%>
<% end %>


<table class="table table-boldered">
  <thread>
  <tr>
    <td>Title</td>
    <td>Description</td>
  </tr>
  </thread>

  <tbody>
  <% @course.videos.each do |v| %>
  <tr>
    <td>
      <%= link_to(v.title, course_video_path(@course, v)) %>
    </td>
    <td>
      <%= v.description %>
    </td>
    <td>
    <% if current_user && current_user == @course.user %>
      <%= link_to("Edit", edit_course_video_path(@course, v)) %>
      <%= link_to("Destroy", course_video_path(@course, v), :method => :delete, :data => { :confirm => "Are you sure?" }) %>
    <% end %>
    </td>
  </tr>
  <% end %>
  </tbody>
</table>
</div>
